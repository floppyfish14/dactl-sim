<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

    <script>
    var config = {
        type: Phaser.AUTO,
        width: window.innerWidth,
        height: window.innerHeight,
        autoCenter: true,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 200 }
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);

    function preload ()
    {
        this.load.setBaseURL('http://localhost:8000/');

        this.load.image('background', 'assets/background.png');
        this.load.image('dactl', 'assets/dactl.png');
        this.load.image('stickman', 'assets/stickman.png');
        this.load.image('ufo', 'assets/ufo.png');
        this.load.image('laser', 'assets/laser.png');
        this.load.image('spear', 'assets/spear.png');
        this.load.image('poop', 'assets/poop.png');
        this.load.image('start', 'assets/start.png');
        this.load.image('spaceBar', 'assets/spaceBar.png')
    }

    function create ()
    {
        poops = this.physics.add.group();

        let bg=this.add.image(0, 0, 'background');

        bg.displayHeight=this.sys.game.config.height;
        bg.scaleX=bg.scaleY;

        bg.y=game.config.height/2;
        bg.x=game.config.width/2;

        logo = this.add.image(bg.x, bg.y, 'start');
        startText = this.add.text(bg.x*0.87, bg.y*1.2, 'Press Shift to start', { color: 'black', fontSize: '24px' });
        
        let spaceBarImage = this.add.image(game.config.width*0.85, bg.y*0.1, 'spaceBar')

        player = this.physics.add.sprite(bg.x, bg.y, 'dactl');
        player.setCollideWorldBounds(true);

        mousePointer = this.input;

        //  Input Events
        cursors = this.input.keyboard.createCursorKeys();
        spacebar = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);


        // logo.setVelocity(100, 200);
        // logo.setBounce(1, 1);
        // logo.setCollideWorldBounds(true);
    }

    function update()
    {
        var timer = 0;
        var flipFlop;

        player.x = mousePointer.x;
        player.y = mousePointer.y;
        player.allowedToPoop = true;

        if (cursors.shift.isDown) {
            logo.visible = false;
            startText.visible = false;
        }

        if (Phaser.Input.Keyboard.JustDown(spacebar)) {
            var poop = poops.create(player.x, player.y, 'poop');
            poop.setVelocityY(+300);
        }
    }

    function listener (sprite, pointer) {
        var x = pointer.x;
        var y = pointer.y;

        sprite.x = x;
        sprite.y = y;
    }
    </script>

</body>
</html>